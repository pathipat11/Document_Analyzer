{% extends "documents/base.html" %}
{% block title %}Detail Â· Document Analyzer{% endblock %}

{% block content %}
<div class="grid grid-cols-1 gap-5 lg:grid-cols-3">
    <div class="card p-6 lg:col-span-1">
        <h1 class="text-lg font-semibold">Document</h1>
        <dl class="mt-4 space-y-2 text-sm">
            <div class="flex justify-between gap-3">
                <dt class="text-slate-500 dark:text-slate-400">File</dt>
                <dd class="font-medium text-right">{{ doc.file_name }}</dd>
            </div>
            <div class="flex justify-between gap-3">
                <dt class="text-slate-500 dark:text-slate-400">Ext</dt>
                <dd class="text-right">{{ doc.file_ext }}</dd>
            </div>
            <div class="flex justify-between gap-3">
                <dt class="text-slate-500 dark:text-slate-400">MIME</dt>
                <dd class="text-right">{{ doc.mime_type }}</dd>
            </div>
            <div class="flex justify-between gap-3">
                <dt class="text-slate-500 dark:text-slate-400">Type</dt>
                <dd class="text-right">{{ doc.document_type }}</dd>
            </div>
            <div class="flex justify-between gap-3">
                <dt class="text-slate-500 dark:text-slate-400">Words</dt>
                <dd class="text-right">{{ doc.word_count }}</dd>
            </div>
            <div class="flex justify-between gap-3">
                <dt class="text-slate-500 dark:text-slate-400">Chars</dt>
                <dd class="text-right">{{ doc.char_count }}</dd>
            </div>
            <div class="flex justify-between gap-3">
                <dt class="text-slate-500 dark:text-slate-400">Uploaded</dt>
                <dd class="text-right">{{ doc.uploaded_at }}</dd>
            </div>
        </dl>

        <div class="mt-5 flex flex-wrap gap-2">
            <a class="btn-outline" href="{% url 'documents:file' doc.pk %}" target="_blank" rel="noopener">
                View File
            </a>
            <a class="btn-outline" href="{% url 'documents:reprocess' doc.pk %}">Reprocess</a>
            <a class="btn" href="{% url 'documents:chat_document' doc.pk %}">Chat about this document</a>
        </div>
    </div>

    <div class="lg:col-span-2 space-y-5">
        <div class="card p-6">
            <h2 class="text-lg font-semibold">Summary</h2>
            <p class="mt-3 text-sm leading-relaxed text-slate-700 dark:text-slate-200">
                {% if doc.summary %}
                {{ doc.summary }}
                {% else %}
                (summary not available)
                {% endif %}
            </p>
        </div>

        <div class="card p-6">
            <h2 class="text-lg font-semibold">Status</h2>
        
            <div class="mt-2 text-sm">
                <div>
                    <span class="text-slate-500">Status:</span>
                    <span class="font-medium">{{ doc.status }}</span>
                </div>
        
                {% if doc.error %}
                <div class="mt-2 rounded-lg bg-red-50 p-3 text-red-700 dark:bg-red-950/40 dark:text-red-200">
                    {{ doc.error }}
                </div>
                {% endif %}
            </div>
        </div>
        <div class="card p-6">
            <h2 class="text-lg font-semibold">Preview</h2>
            <pre
                class="mt-3 whitespace-pre-wrap rounded-xl bg-slate-100 p-4 text-xs text-slate-800 dark:bg-slate-950 dark:text-slate-200">{{ doc.extracted_text|truncatechars:1800|default:"(not extracted yet)" }}</pre>
        </div>
    </div>
</div>
{% endblock %}